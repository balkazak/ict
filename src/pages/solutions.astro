---
import Layout from "@/layouts/Layout.astro";
import { Icon } from "astro-icon/components";
import { Image } from "astro:assets";
import { Fragment } from "astro/components";
import Icon from "@/components/Icon.astro";

import heroImage from "@/assets/page-solutions.png";
import forestTwinImg from "@/assets/solution-page/1.jpeg";
import nurseryImg from "@/assets/solution-page/6.jpg";
import environmentImg from "@/assets/solution-page/5.jpg";
import smartAgricultureImg from "@/assets/solution-page/4.jpg";
import climateRisksImg from "@/assets/solution-page/1.webp";

// Import SVG icons as components
import TreeIcon from "@/assets/icons/tree.svg";
import SproutIcon from "@/assets/icons/sprout.svg";
import EarthIcon from "@/assets/icons/earth.svg";
import TractorIcon from "@/assets/icons/tractor.svg";
import WeatherIcon from "@/assets/icons/weather.svg";

const icons = {
  tree: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-8 w-8">
    <path fill="currentColor" d="M12 2L4 12h3v9h6v-6h2v6h6v-9h3L12 2z"/>
  </svg>`,
  sprout: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-8 w-8">
    <path fill="currentColor" d="M2 22v-2h20v2H2zm3-3V9c0-2.21 1.79-4 4-4h6c2.21 0 4 1.79 4 4v10H5zm7-13c-1.1 0-2-.9-2-2s.9-2 2-2s2 .9 2 2s-.9 2-2 2z"/>
  </svg>`,
  // ... other icons
};

// Define solutions data
const solutions = [
  {
    id: "forest-twin",
    title: "Цифровой двойник лесов",
    shortDesc: "Комплексная система мониторинга и управления лесными ресурсами",
    image: forestTwinImg,
    color: "#004D45",
    icon: "tree",
    features: [
      "Сенсоры сокодвижения для мониторинга водопотребления деревьев",
      "Метеостанции для анализа климатических параметров",
      "NDVI-сканеры для оценки фотосинтетической активности",
      "Интеграция данных в единую аналитическую платформу"
    ],
    fullDesc: "Цифровой двойник лесов представляет собой комплексное решение для мониторинга, анализа и прогнозирования состояния лесных экосистем. Система объединяет данные с IoT-датчиков, спутниковых снимков и наземных измерений для создания точной цифровой модели леса. Это позволяет отслеживать рост деревьев, поглощение углерода, водный баланс и общее состояние экосистемы в режиме реального времени."
  },
  {
    id: "nursery",
    title: "Современный питомник",
    shortDesc: "Автоматизированная система выращивания саженцев с контролем всех параметров",
    image: nurseryImg,
    icon: "sprout",
    color: "#0A7B76",
    features: [
      "Автоматизированный полив и внесение удобрений",
      "Контроль микроклимата в теплицах",
      "Мониторинг роста и развития саженцев",
      "Система раннего выявления болезней и вредителей"
    ],
    fullDesc: "Современный питомник — это высокотехнологичный комплекс для выращивания качественного посадочного материала. Система включает автоматизированное управление микроклиматом, полив с учетом потребностей растений, мониторинг роста и развития саженцев. Интеллектуальные алгоритмы оптимизируют все процессы, что позволяет повысить выживаемость саженцев и ускорить их рост."
  },
  {
    id: "environment",
    title: "Мониторинг окружающей среды",
    shortDesc: "Комплексный контроль экологических параметров для оценки состояния природных экосистем",
    image: environmentImg,
    icon: "earth",
    color: "#2A9D8F",
    features: [
      "Мониторинг качества воздуха и воды",
      "Отслеживание биоразнообразия",
      "Контроль уровня загрязнений",
      "Оценка состояния почв и растительности"
    ],
    fullDesc: "Система мониторинга окружающей среды обеспечивает непрерывный сбор и анализ данных о состоянии экосистем. Сеть датчиков измеряет ключевые параметры воздуха, воды, почвы и биоразнообразия. Аналитическая платформа обрабатывает данные, выявляет тренды и аномалии, формирует прогнозы и рекомендации для принятия экологически обоснованных решений."
  },
  {
    id: "agriculture",
    title: "Умное сельское хозяйство",
    shortDesc: "Интеллектуальные решения для повышения эффективности и устойчивости агропромышленного комплекса",
    image: smartAgricultureImg,
    icon: "tractor",
    color: "#3D8361",
    features: [
      "Точное земледелие с использованием IoT-датчиков",
      "Оптимизация полива и внесения удобрений",
      "Мониторинг состояния посевов и прогнозирование урожайности",
      "Интеграция с системами управления сельхозтехникой"
    ],
    fullDesc: "Умное сельское хозяйство объединяет современные технологии для оптимизации всех аспектов сельскохозяйственного производства. Система включает сеть датчиков для мониторинга состояния почвы и посевов, метеостанции для прогнозирования погодных условий, дроны для аэрофотосъемки полей. Аналитическая платформа обрабатывает данные и формирует рекомендации по оптимальным срокам посева, полива, внесения удобрений и сбора урожая."
  },
  {
    id: "climate",
    title: "Климатические риски",
    shortDesc: "Системы оценки и прогнозирования климатических изменений и связанных с ними рисков",
    image: climateRisksImg,
    icon: "weather",
    color: "#1A5653",
    features: [
      "Моделирование климатических сценариев",
      "Оценка углеродного следа предприятий",
      "Прогнозирование экстремальных погодных явлений",
      "Разработка стратегий адаптации к изменению климата"
    ],
    fullDesc: "Система оценки климатических рисков предоставляет инструменты для анализа влияния климатических изменений на бизнес и экосистемы. Платформа интегрирует климатические модели, исторические данные и прогнозы для выявления потенциальных рисков и возможностей. Решение помогает организациям разрабатывать стратегии адаптации к изменению климата и снижения углеродного следа."
  }
];
---

<Layout title="Решения | ICT Central Asia">
  {/* Hero Section with Animated Background */}
  <section class="relative min-h-[80vh] overflow-hidden bg-gradient-to-br from-[#004D45] to-[#003532] text-white">
    <div class="absolute inset-0">
      <Image 
        src={heroImage}
        alt="Innovative solutions for environmental monitoring"
        width={1920}
        height={1080}
        class="w-full h-full object-cover opacity-20"
      />
    </div>
    
    {/* Floating Elements */}
    <div class="absolute inset-0 overflow-hidden">
      {Array.from({ length: 20 }).map((_, i) => (
        <div
          class="eco-floating-element absolute"
          style={{
            left: `${Math.random() * 100}%`,
            top: `${Math.random() * 100}%`,
            animationDelay: `${Math.random() * 5}s`,
            animationDuration: `${Math.random() * 10 + 10}s`
          }}
        />
      ))}
    </div>

    <div class="container relative mx-auto max-w-6xl px-4 py-24">
      <div class="flex flex-col items-center text-center">
        <div class="eco-badge mb-8 animate-float">
          <span class="text-white font-medium">Инновационные решения</span>
        </div>
        
        <h1 class="max-w-4xl text-4xl md:text-6xl font-bold mb-8 leading-tight">
          Мы являемся вендором <span class="text-[#95C11F] eco-glow">инновационных систем</span> мониторинга
        </h1>
        
        <p class="text-xl text-white opacity-80 max-w-2xl mb-12">
          Объединяем IoT-датчики, искусственный интеллект и облачные технологии для создания эффективных решений
        </p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 w-full max-w-4xl">
          <div class="eco-stat-card">
            <div class="text-4xl font-bold text-[#95C11F]">30%</div>
            <div class="text-sm opacity-80">Повышение эффективности</div>
          </div>
          <div class="eco-stat-card">
            <div class="text-4xl font-bold text-[#95C11F]">24/7</div>
            <div class="text-sm opacity-80">Мониторинг в реальном времени</div>
          </div>
          <div class="eco-stat-card">
            <div class="text-4xl font-bold text-[#95C11F]">50+</div>
            <div class="text-sm opacity-80">Реализованных проектов</div>
          </div>
        </div>
      </div>
    </div>

    {/* Hero Bottom Wave */}
    <div class="absolute bottom-0 left-0 w-full">
      <svg viewBox="0 0 1440 120" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M0 30L48 35C96 40 192 50 288 55C384 60 480 60 576 55C672 50 768 40 864 35C960 30 1056 30 1152 35C1248 40 1344 50 1392 55L1440 60V120H1392C1344 120 1248 120 1152 120C1056 120 960 120 864 120C768 120 672 120 576 120C480 120 384 120 288 120C192 120 96 120 48 120H0V30Z" fill="white"/>
      </svg>
    </div>
  </section>

  {/* Solutions Grid */}
  <section class="py-20 bg-white relative overflow-hidden">
    <div class="eco-grid-background absolute inset-0 opacity-10">
      <div class="eco-grid"></div>
      <div class="eco-grid-glow"></div>
    </div>
    
    <div class="container relative mx-auto max-w-6xl px-4">
      <div class="text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold text-[#004D45] mb-4">Наши решения</h2>
        <p class="text-gray-600 max-w-2xl mx-auto">Выберите решение, чтобы узнать подробнее о его возможностях и преимуществах</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {solutions.map((solution) => (
          <div class="solution-card open-modal-btn cursor-pointer" data-solution={solution.id}>
            <div class="solution-icon" style={`background: ${solution.color}20; color: ${solution.color};`}>
              <Icon name={solution.icon} class="h-8 w-8" />
            </div>
            <h3 class="text-xl font-bold mb-2 text-[#004D45]">{solution.title}</h3>
            <p class="text-gray-600 mb-4">{solution.shortDesc}</p>
            <button class="text-[#004D45] font-medium hover:text-[#95C11F] transition-colors flex items-center">
              Подробнее
              <Icon name="mdi:arrow-right" class="ml-1 h-5 w-5" />
            </button>
          </div>
        ))}
      </div>
    </div>
  </section>

  {/* CTA Section */}
  <section class="py-20 bg-[#004D45] text-white relative overflow-hidden">
    <div class="eco-particles"></div>
    
    <div class="container mx-auto max-w-4xl px-4 relative z-10">
      <div class="text-center">
        <h2 class="text-3xl md:text-4xl font-bold mb-6">Готовы внедрить инновационные решения?</h2>
        <p class="text-xl opacity-90 mb-10 max-w-2xl mx-auto">
          Наши эксперты помогут подобрать оптимальное решение для ваших задач и обеспечат полное сопровождение на всех этапах внедрения
        </p>
        <a href="/contact" class="inline-block bg-[#95C11F] text-[#004D45] font-bold py-4 px-8 rounded-lg transition-all transform hover:scale-105 hover:shadow-lg">
          Связаться с нами
        </a>
      </div>
    </div>
  </section>

  {/* Solution Modals */}
  {solutions.map((solution) => (
    <div id={`modal-${solution.id}`} class="solution-modal fixed inset-0 z-50 flex items-center justify-center hidden">
      <div class="modal-overlay absolute inset-0 bg-black opacity-50"></div>
      <div class="modal-container bg-white w-full max-w-3xl mx-4 rounded-lg shadow-2xl relative z-10">
        <!-- Modal Header with Image -->
        <div class="relative h-48 md:h-64 rounded-t-lg overflow-hidden">
          <Image 
            src={solution.image} 
            alt={solution.title}
            width={800}
            height={400}
            class="w-full h-full object-cover"
          />
          <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end">
            <div class="p-6">
              <h3 class="text-2xl md:text-3xl font-bold text-white">{solution.title}</h3>
            </div>
          </div>
          <button class="close-modal absolute top-4 right-4 bg-white/20 hover:bg-white/40 rounded-full px-2 text-white transition-colors backdrop-blur-sm">
            X
          </button>
        </div>
        
        <!-- Modal Content -->
        <div class="p-6 max-h-[50vh] overflow-y-auto">
          <p class="text-gray-700 mb-6">{solution.fullDesc}</p>
          
          <h4 class="text-lg font-bold text-[#004D45] mb-4">Ключевые возможности:</h4>
          <ul class="space-y-2 mb-6">
            {solution.features.map((feature) => (
              <li class="flex items-start">
                <span class="text-[#95C11F] mr-2 mt-1">
                  <Icon name="mdi:check-circle" class="h-5 w-5" />
                </span>
                <span>{feature}</span>
              </li>
            ))}
          </ul>
        </div>
        
        <!-- Modal Footer -->
        <div class="border-t border-gray-200 p-4 flex justify-end sticky bottom-0 bg-white rounded-b-lg">
          <button class="close-modal mr-4 text-gray-600 hover:text-gray-900 font-medium">
            Закрыть
          </button>
          <a href="/contact" class="bg-[#004D45] hover:bg-[#003532] text-white font-medium py-2 px-6 rounded-lg transition-colors">
            Запросить демонстрацию
          </a>
        </div>
      </div>
    </div>
  ))}
</Layout>

<style>
  /* Floating elements animation */
  .eco-floating-element {
    width: 10px;
    height: 10px;
    background-color: rgba(149, 193, 31, 0.3);
    border-radius: 50%;
    animation: float 15s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.3; }
    25% { transform: translate(50px, -30px) scale(1.5); opacity: 0.5; }
    50% { transform: translate(100px, 20px) scale(1); opacity: 0.3; }
    75% { transform: translate(50px, 50px) scale(1.5); opacity: 0.5; }
  }

  /* Eco badge */
  .eco-badge {
    background: rgba(149, 193, 31, 0.2);
    border-radius: 2rem;
    padding: 0.5rem 1.5rem;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(149, 193, 31, 0.3);
  }

  /* Stat cards */
  .eco-stat-card {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 1rem;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
  }

  .eco-stat-card:hover {
    transform: translateY(-5px);
    background: rgba(255, 255, 255, 0.15);
  }

  /* Solution cards */
  .solution-card {
    background: white;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    position: relative;
    z-index: 1;
    border: 1px solid rgba(0, 77, 69, 0.05);
  }

  .solution-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
    border-color: rgba(0, 77, 69, 0.1);
  }

  .solution-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1rem;
    transition: all 0.3s ease;
  }

  .solution-card:hover .solution-icon {
    transform: scale(1.1);
  }

  /* Grid background */
  .eco-grid-background {
    perspective: 1000px;
    transition: all 0.5s ease;
  }

  .eco-grid {
    position: absolute;
    inset: -100px;
    background-image: 
      linear-gradient(rgba(0, 77, 69, 0.1) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0, 77, 69, 0.1) 1px, transparent 1px);
    background-size: 40px 40px;
    transform: rotateX(60deg);
    animation: gridMove 10s linear infinite;
  }

  .eco-grid-glow {
    position: absolute;
    width: 300px;
    height: 300px;
    background: radial-gradient(circle, rgba(149, 193, 31, 0.2) 0%, transparent 70%);
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: glowPulse 4s ease-in-out infinite;
  }

  /* Eco particles */
  .eco-particles {
    position: absolute;
    inset: 0;
    overflow: hidden;
  }

  .eco-particles::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image: radial-gradient(rgba(255, 255, 255, 0.3) 1px, transparent 1px);
    background-size: 30px 30px;
    opacity: 0.2;
  }

  /* Modal styles */
  .solution-modal {
    transition: all 0.3s ease;
  }

  .modal-container {
    transform: translateY(0);
    transition: transform 0.3s ease;
  }

  .solution-modal.hidden .modal-container {
    transform: translateY(20px);
  }

  .modal-overlay {
    transition: opacity 0.3s ease;
  }

  .solution-modal.hidden .modal-overlay {
    opacity: 0;
  }

  /* Animations */
  @keyframes gridMove {
    from { transform: rotateX(60deg) translateY(0); }
    to { transform: rotateX(60deg) translateY(40px); }
  }

  @keyframes glowPulse {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.7; }
  }

  .animate-float {
    animation: float 6s ease-in-out infinite;
  }

  .eco-glow {
    text-shadow: 0 0 10px rgba(149, 193, 31, 0.5);
  }
</style>

<script>
  // Modal functionality
  document.addEventListener('DOMContentLoaded', function() {
    // Open modal when clicking on a solution card
    document.querySelectorAll('.solution-card').forEach(card => {
      card.addEventListener('click', () => {
        const solutionId = card.getAttribute('data-solution');
        const modal = document.getElementById(`modal-${solutionId}`);
        
        if (modal) {
          modal.classList.remove('hidden');
          document.body.style.overflow = 'hidden'; // Prevent scrolling
        }
      });
    });
    
    // Close modal when clicking on close button or overlay
    document.querySelectorAll('.close-modal, .modal-overlay').forEach(element => {
      element.addEventListener('click', () => {
        document.querySelectorAll('.solution-modal').forEach(modal => {
          modal.classList.add('hidden');
          document.body.style.overflow = ''; // Re-enable scrolling
        });
      });
    });
    
    // Prevent modal from closing when clicking inside the modal content
    document.querySelectorAll('.modal-container').forEach(container => {
      container.addEventListener('click', (e) => {
        e.stopPropagation();
      });
    });
  });
</script>
